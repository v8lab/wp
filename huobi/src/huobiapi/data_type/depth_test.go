package data_type

import (
	"fmt"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestDecodeDepth(t *testing.T) {
	str := `{"ch":"market.eosusdt.depth.step0","tick":{"asks":[[14.300000000000000000,1193.585700000000000000],[14.310000000000000000,2381.404600000000000000],[14.320000000000000000,77.406500000000000000],[14.330000000000000000,145.950000000000000000],[14.340000000000000000,1964.742736401673640227],[14.350000000000000000,9.364300000000000000],[14.370000000000000000,485.604400000000000000],[14.380000000000000000,1314.860700000000000000],[14.390000000000000000,201.000000000000000000],[14.400000000000000000,3697.303500000000000000],[14.430000000000000000,19.689300000000000000],[14.450000000000000000,849.854100000000000000],[14.480000000000000000,867.558000000000000000],[14.490000000000000000,171.723100000000000000],[14.500000000000000000,909.721300000000000000],[14.510000000000000000,800.594000000000000000],[14.520000000000000000,20.932200000000000000],[14.530000000000000000,99.551900000000000000],[14.540000000000000000,0.240000000000000000],[14.550000000000000000,1895.046800000000000000],[14.560000000000000000,0.600000000000000000],[14.570000000000000000,0.320000000000000000],[14.580000000000000000,687.200800000000000000],[14.600000000000000000,337.976000000000000000],[14.610000000000000000,0.200000000000000000],[14.630000000000000000,50.000000000000000000],[14.650000000000000000,325.838800000000000000],[14.660000000000000000,149.246100000000000000],[14.690000000000000000,115.000000000000000000],[14.700000000000000000,3009.519100000000000000],[14.710000000000000000,1590.000000000000000000],[14.720000000000000000,497.000000000000000000],[14.730000000000000000,106.206800000000000000],[14.740000000000000000,349.300000000000000000],[14.750000000000000000,2336.622300000000000000],[14.760000000000000000,173.089500000000000000],[14.770000000000000000,46.995800000000000000],[14.780000000000000000,490.723700000000000000],[14.790000000000000000,76.922100000000000000],[14.800000000000000000,3456.700300000000000000],[14.810000000000000000,1.000000000000000000],[14.820000000000000000,27.909800000000000000],[14.830000000000000000,39.992000000000000000],[14.840000000000000000,396.891100000000000000],[14.850000000000000000,2656.157700000000000000],[14.860000000000000000,91.000000000000000000],[14.870000000000000000,91.283300000000000000],[14.880000000000000000,844.619100000000000000],[14.890000000000000000,3697.050100000000000000],[14.900000000000000000,7182.320500000000000000],[14.910000000000000000,1103.890300000000000000],[14.920000000000000000,1072.395800000000000000],[14.930000000000000000,1939.847500000000000000],[14.940000000000000000,664.064500000000000000],[14.950000000000000000,7771.676600000000000000],[14.960000000000000000,1501.176300000000000000],[14.970000000000000000,1585.237600000000000000],[14.980000000000000000,3173.592800000000000000],[14.990000000000000000,3254.982800000000000000],[15.000000000000000000,44272.568861981282633340],[15.010000000000000000,902.890900000000000000],[15.020000000000000000,24.407000000000000000],[15.030000000000000000,283.974600000000000000],[15.050000000000000000,807.331600000000000000],[15.060000000000000000,116.675100000000000000],[15.070000000000000000,110.000000000000000000],[15.080000000000000000,26.693600000000000000],[15.090000000000000000,50.225300000000000000],[15.100000000000000000,2203.676000000000000000],[15.110000000000000000,2571.064400000000000000],[15.120000000000000000,2188.194300000000000000],[15.130000000000000000,60.801700000000000000],[15.140000000000000000,108.310700000000000000],[15.150000000000000000,1147.587300000000000000],[15.160000000000000000,55.888300000000000000],[15.170000000000000000,95.726500000000000000],[15.180000000000000000,311.802400000000000000],[15.190000000000000000,381.158600000000000000],[15.200000000000000000,6710.143300000000000000],[15.210000000000000000,27.617600000000000000],[15.220000000000000000,230.000000000000000000],[15.230000000000000000,443.938400000000000000],[15.240000000000000000,314.831200000000000000],[15.250000000000000000,1208.323000000000000000],[15.260000000000000000,584.978800000000000000],[15.270000000000000000,30.394500000000000000],[15.280000000000000000,457.230900000000000000],[15.290000000000000000,678.919400000000000000],[15.300000000000000000,4369.197000000000000000],[15.310000000000000000,69.138800000000000000],[15.320000000000000000,69.949400000000000000],[15.330000000000000000,1131.032700000000000000],[15.350000000000000000,121.144500000000000000],[15.360000000000000000,40.323600000000000000],[15.370000000000000000,209.801600000000000000],[15.380000000000000000,1237.828900000000000000],[15.390000000000000000,358.387000000000000000],[15.400000000000000000,6172.521800000000000000],[15.410000000000000000,50.000000000000000000],[15.420000000000000000,215.889100000000000000],[15.430000000000000000,100.647500000000000000],[15.440000000000000000,310.562400000000000000],[15.450000000000000000,1340.311000000000000000],[15.460000000000000000,429.576500000000000000],[15.470000000000000000,206.221200000000000000],[15.480000000000000000,2542.768200000000000000],[15.490000000000000000,823.304600000000000000],[15.500000000000000000,12748.668400000000000000]],"bids":[[14.290000000000000000,21.575700000000000000],[14.280000000000000000,321.640000000000000000],[14.270000000000000000,1155.232400000000000000],[14.260000000000000000,2.050000000000000000],[14.250000000000000000,422.251500000000000000],[14.240000000000000000,1.000000000000000000],[14.230000000000000000,93.000000000000000000],[14.220000000000000000,461.491600000000000000],[14.210000000000000000,1599.162900000000000000],[14.200000000000000000,5236.403000000000000000],[14.190000000000000000,122.250000000000000000],[14.180000000000000000,22.541800000000000000],[14.170000000000000000,5.000000000000000000],[14.160000000000000000,226.494300000000000000],[14.150000000000000000,833.594500000000000000],[14.140000000000000000,146.383000000000000000],[14.130000000000000000,14.578900000000000000],[14.120000000000000000,1758.332483984472204246],[14.110000000000000000,322.096500000000000000],[14.100000000000000000,3994.923700000000000000],[14.090000000000000000,518.000000000000000000],[14.080000000000000000,280.430300000000000000],[14.070000000000000000,383.709600000000000000],[14.060000000000000000,1141.697500000000000000],[14.050000000000000000,1213.425800000000000000],[14.040000000000000000,4378.613600000000000000],[14.030000000000000000,6367.148700000000000000],[14.020000000000000000,1121.091300000000000000],[14.010000000000000000,6498.662600000000000000],[14.000000000000000000,21826.453500000000000000],[13.990000000000000000,9.623600000000000000],[13.980000000000000000,52.000000000000000000],[13.960000000000000000,371.853600000000000000],[13.950000000000000000,1511.658000000000000000],[13.940000000000000000,24.911600000000000000],[13.930000000000000000,114.697700000000000000],[13.920000000000000000,55.000000000000000000],[13.910000000000000000,2016.000000000000000000],[13.900000000000000000,15073.129600000000000000],[13.890000000000000000,4.000000000000000000],[13.880000000000000000,2883.895100000000000000],[13.870000000000000000,2495.916907035866183400],[13.860000000000000000,65.071100000000000000],[13.850000000000000000,1079.405400000000000000],[13.840000000000000000,1099.678100000000000000],[13.830000000000000000,50.000000000000000000],[13.820000000000000000,884.128000000000000000],[13.810000000000000000,5690.212400000000000000],[13.800000000000000000,16045.125900000000000000],[13.790000000000000000,3987.862100000000000000],[13.780000000000000000,293.670000000000000000],[13.770000000000000000,215.301600000000000000],[13.760000000000000000,46.270600000000000000],[13.750000000000000000,344.312300000000000000],[13.730000000000000000,111.164800000000000000],[13.720000000000000000,30.388400000000000000],[13.710000000000000000,1069.090100000000000000],[13.700000000000000000,33417.574400000000000000],[13.690000000000000000,61.091200000000000000],[13.680000000000000000,938.811800000000000000],[13.660000000000000000,115.000000000000000000],[13.650000000000000000,484.371900000000000000],[13.640000000000000000,11.614500000000000000],[13.620000000000000000,100.000000000000000000],[13.610000000000000000,14.553600000000000000],[13.600000000000000000,10126.395500000000000000],[13.590000000000000000,215.649115305371596700],[13.580000000000000000,239.625000000000000000],[13.570000000000000000,649.168000000000000000],[13.560000000000000000,368.252800000000000000],[13.550000000000000000,2317.154100000000000000],[13.530000000000000000,92.978400000000000000],[13.520000000000000000,709.539300000000000000],[13.510000000000000000,1307.123600000000000000],[13.500000000000000000,16068.829300000000000000],[13.480000000000000000,1177.000000000000000000],[13.470000000000000000,61.442400000000000000],[13.450000000000000000,1620.985400000000000000],[13.440000000000000000,50.000000000000000000],[13.420000000000000000,313.795100000000000000],[13.410000000000000000,62.790100000000000000],[13.400000000000000000,7845.942800000000000000],[13.380000000000000000,29.878500000000000000],[13.370000000000000000,758.882800000000000000],[13.360000000000000000,232.955500000000000000],[13.350000000000000000,231.550800000000000000],[13.340000000000000000,4.134300000000000000],[13.330000000000000000,1039.190400000000000000],[13.310000000000000000,2120.000000000000000000],[13.300000000000000000,5331.823900000000000000],[13.290000000000000000,50.000000000000000000],[13.280000000000000000,66.601900000000000000],[13.260000000000000000,625.698000000000000000],[13.250000000000000000,753.181500000000000000],[13.240000000000000000,307.003200000000000000],[13.230000000000000000,52.386900000000000000],[13.220000000000000000,157.876800000000000000],[13.210000000000000000,1335.932000000000000000],[13.200000000000000000,3202.251500000000000000],[13.190000000000000000,19.394200000000000000],[13.180000000000000000,1462.282700000000000000],[13.170000000000000000,190.431100000000000000],[13.160000000000000000,50.942900000000000000],[13.150000000000000000,1801.577200000000000000],[13.140000000000000000,20.000000000000000000],[13.130000000000000000,2204.928000000000000000],[13.120000000000000000,288.704400000000000000],[13.110000000000000000,373.186100000000000000],[13.100000000000000000,1407.931600000000000000],[13.090000000000000000,99.729600000000000000],[13.080000000000000000,3849.886500000000000000],[13.070000000000000000,58.088300000000000000],[13.060000000000000000,538.658900000000000000],[13.050000000000000000,361.466900000000000000],[13.040000000000000000,2384.027055107361963100],[13.030000000000000000,1766.440500000000000000],[13.020000000000000000,1788.756900000000000000],[13.010000000000000000,2419.736200000000000000],[13.000000000000000000,31833.745200000000000000],[12.990000000000000000,503.132400000000000000],[12.980000000000000000,290.943200000000000000],[12.960000000000000000,2147.907200000000000000],[12.950000000000000000,36.328100000000000000],[12.930000000000000000,5.000000000000000000],[12.920000000000000000,20.000000000000000000],[12.910000000000000000,740.454400000000000000],[12.900000000000000000,1784.173400000000000000],[12.890000000000000000,343.741600000000000000],[12.880000000000000000,954.426600000000000000],[12.870000000000000000,170.255400000000000000],[12.860000000000000000,533.173200000000000000],[12.850000000000000000,329.352800000000000000],[12.830000000000000000,0.049200000000000000],[12.820000000000000000,5.000000000000000000],[12.810000000000000000,594.390500000000000000],[12.800000000000000000,4878.719600000000000000],[12.790000000000000000,107.000000000000000000],[12.780000000000000000,413.504400000000000000],[12.770000000000000000,805.000000000000000000],[12.750000000000000000,172.050200000000000000],[12.740000000000000000,21.200000000000000000],[12.730000000000000000,247.115100000000000000],[12.720000000000000000,302.700000000000000000],[12.710000000000000000,109.020000000000000000],[12.700000000000000000,1659.270300000000000000]],"ts":1516870810023,"version":1557850542},"ts":1516870811119}`
	data, err := DecodeDepth([]byte(str))
	assert.NoError(t, err)
	fmt.Println(data)
	assert.Equal(t, "market.eosusdt.depth.step0", data.Ch)
	assert.Equal(t, uint(1516870811119), data.Ts)
	assert.Equal(t, []float64{14.3, 1193.5857}, data.Tick.Asks[0])
	assert.Equal(t, []float64{14.29, 21.5757}, data.Tick.Bids[0])
}
